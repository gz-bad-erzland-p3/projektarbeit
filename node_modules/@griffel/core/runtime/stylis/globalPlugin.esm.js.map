{"version":3,"file":"globalPlugin.esm.js","sources":["../../../../../packages/core/src/runtime/stylis/globalPlugin.ts"],"sourcesContent":["import { RULESET, tokenize } from 'stylis';\nimport type { Middleware } from 'stylis';\n\nexport const globalPlugin: Middleware = element => {\n  switch (element.type) {\n    case RULESET:\n      if (typeof element.props === 'string') {\n        if (process.env.NODE_ENV !== 'production') {\n          throw new Error(\n            `\"element.props\" has type \"string\" (${JSON.stringify(\n              element.props,\n              null,\n              2,\n            )}), it's not expected. Please report a bug if it happens.`,\n          );\n        }\n\n        return;\n      }\n\n      element.props = element.props.map(value => {\n        // Avoids calling tokenize() on every string\n        if (value.indexOf(':global(') === -1) {\n          return value;\n        }\n\n        return tokenize(value)\n          .reduce<string[]>((acc, value, index, children) => {\n            if (value === '') {\n              return acc;\n            }\n\n            if (value === ':' && children[index + 1] === 'global') {\n              const selector =\n                // An inner part of \":global()\"\n                children[index + 2].slice(1, -1) +\n                // A separator between selectors i.e. \"body .class\"\n                ' ';\n\n              acc.unshift(selector);\n\n              children[index + 1] = '';\n              children[index + 2] = '';\n\n              return acc;\n            }\n\n            acc.push(value);\n            return acc;\n          }, [])\n          .join('');\n      });\n  }\n};\n"],"names":["globalPlugin","element","type","RULESET","props","process","env","NODE_ENV","Error","JSON","stringify","map","value","indexOf","tokenize","reduce","acc","index","children","selector","slice","unshift","push","join"],"mappings":";;MAGaA,YAAY,GAAeC,OAAO;EAC7C,QAAQA,OAAO,CAACC,IAAhB;IACE,KAAKC,OAAL;MACE,IAAI,OAAOF,OAAO,CAACG,KAAf,KAAyB,QAA7B,EAAuC;QACrC,IAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;UACzC,MAAM,IAAIC,KAAJ,uCACkCC,IAAI,CAACC,SAAL,CACpCT,OAAO,CAACG,KAD4B,EAEpC,IAFoC,EAGpC,CAHoC,2DADlC,CAAN;;;QASF;;;MAGFH,OAAO,CAACG,KAAR,GAAgBH,OAAO,CAACG,KAAR,CAAcO,GAAd,CAAkBC,KAAK;;QAErC,IAAIA,KAAK,CAACC,OAAN,CAAc,UAAd,MAA8B,CAAC,CAAnC,EAAsC;UACpC,OAAOD,KAAP;;;QAGF,OAAOE,QAAQ,CAACF,KAAD,CAAR,CACJG,MADI,CACa,CAACC,GAAD,EAAMJ,KAAN,EAAaK,KAAb,EAAoBC,QAApB;UAChB,IAAIN,KAAK,KAAK,EAAd,EAAkB;YAChB,OAAOI,GAAP;;;UAGF,IAAIJ,KAAK,KAAK,GAAV,IAAiBM,QAAQ,CAACD,KAAK,GAAG,CAAT,CAAR,KAAwB,QAA7C,EAAuD;YACrD,MAAME,QAAQ;YAEZD,QAAQ,CAACD,KAAK,GAAG,CAAT,CAAR,CAAoBG,KAApB,CAA0B,CAA1B,EAA6B,CAAC,CAA9B;YAEA,GAJF;YAMAJ,GAAG,CAACK,OAAJ,CAAYF,QAAZ;YAEAD,QAAQ,CAACD,KAAK,GAAG,CAAT,CAAR,GAAsB,EAAtB;YACAC,QAAQ,CAACD,KAAK,GAAG,CAAT,CAAR,GAAsB,EAAtB;YAEA,OAAOD,GAAP;;;UAGFA,GAAG,CAACM,IAAJ,CAASV,KAAT;UACA,OAAOI,GAAP;SAtBG,EAuBF,EAvBE,EAwBJO,IAxBI,CAwBC,EAxBD,CAAP;OANc,CAAhB;;AAiCL;;;;"}